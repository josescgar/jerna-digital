---
import BaseLayout from '@/layouts/BaseLayout.astro';
import ContactForm from '@/components/interactive/ContactForm';
import {
  getTranslations,
  languages,
  defaultLanguage,
  type Language,
} from '@/i18n/translations';

export function getStaticPaths() {
  return (Object.keys(languages) as Language[]).map((lang) => {
    return {
      params: { lang: lang === defaultLanguage ? undefined : lang },
      props: { lang },
    };
  });
}

interface Props {
  lang: Language;
}

const { lang } = Astro.props;
const t = getTranslations(lang);

const contactMethods = [
  {
    icon: 'mail',
    title: t.contact.methods.email.title,
    description: t.contact.methods.email.description,
    value: 'jose.escobar.dev@gmail.com',
    href: 'mailto:jose.escobar.dev@gmail.com',
  },
  {
    icon: 'linkedin',
    title: t.contact.methods.linkedin.title,
    description: t.contact.methods.linkedin.description,
    value: 'linkedin.com/in/jaescobar',
    href: 'https://linkedin.com/in/jaescobar',
  },
  {
    icon: 'calendar',
    title: t.contact.methods.schedule.title,
    description: t.contact.methods.schedule.description,
    value: t.contact.methods.schedule.comingSoon,
    href: null,
  },
];

// Extract form translations for the ContactForm component
const formTranslations = {
  name: t.contact.form.name,
  namePlaceholder: t.contact.form.namePlaceholder,
  email: t.contact.form.email,
  emailPlaceholder: t.contact.form.emailPlaceholder,
  message: t.contact.form.message,
  messagePlaceholder: t.contact.form.messagePlaceholder,
  submit: t.contact.form.submit,
  sending: t.contact.form.sending,
  success: t.contact.form.success,
  successSubtitle: t.contact.form.successSubtitle,
  error: t.contact.form.error,
  errorSubtitle: t.contact.form.errorSubtitle,
  tryAgain: t.contact.form.tryAgain,
  validation: t.contact.form.validation,
};
---

<BaseLayout
  lang={lang}
  title={t.contact.title}
  description={t.contact.subtitle}
>
  <!-- Hero section -->
  <section class="section relative overflow-hidden">
    <div class="container">
      <div class="mx-auto max-w-3xl text-center">
        <h1 class="text-4xl font-bold tracking-tight sm:text-5xl md:text-6xl">
          <span class="text-gradient">{t.contact.title}</span>
        </h1>
        <p class="text-foreground-muted mt-6 text-xl">
          {t.contact.subtitle}
        </p>
      </div>
    </div>
  </section>

  <!-- Contact content -->
  <section class="section pt-0">
    <div class="container">
      <div class="grid gap-12 lg:grid-cols-2 lg:gap-16">
        <!-- Contact form -->
        <div class="order-2 lg:order-1">
          <div
            class="border-border bg-background-elevated rounded-2xl border p-6 md:p-8"
          >
            <h2 class="text-2xl font-semibold">{t.contact.sendMessage}</h2>
            <p class="text-foreground-muted mt-2">
              {t.contact.sendMessageSubtitle}
            </p>

            <div class="mt-8">
              <ContactForm client:load translations={formTranslations} />
            </div>
          </div>
        </div>

        <!-- Contact info & methods -->
        <div class="order-1 lg:order-2">
          <h2 class="text-2xl font-semibold">{t.contact.otherWays}</h2>
          <p class="text-foreground-muted mt-2">
            {t.contact.otherWaysSubtitle}
          </p>

          <div class="mt-8 space-y-4">
            {
              contactMethods.map((method) => (
                <div class="border-border bg-background-elevated hover:border-border-subtle flex items-start gap-4 rounded-xl border p-4 transition-colors">
                  <div class="bg-gradient-primary text-primary-foreground flex h-12 w-12 shrink-0 items-center justify-center rounded-lg">
                    {method.icon === 'mail' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <rect width="20" height="16" x="2" y="4" rx="2" />
                        <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                      </svg>
                    )}
                    {method.icon === 'linkedin' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
                        <rect width="4" height="12" x="2" y="9" />
                        <circle cx="4" cy="4" r="2" />
                      </svg>
                    )}
                    {method.icon === 'calendar' && (
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path d="M8 2v4" />
                        <path d="M16 2v4" />
                        <rect width="18" height="18" x="3" y="4" rx="2" />
                        <path d="M3 10h18" />
                      </svg>
                    )}
                  </div>
                  <div class="flex-1">
                    <h3 class="font-semibold">{method.title}</h3>
                    <p class="text-foreground-subtle text-sm">
                      {method.description}
                    </p>
                    {method.href ? (
                      <a
                        href={method.href}
                        target={
                          method.href.startsWith('http') ? '_blank' : undefined
                        }
                        rel={
                          method.href.startsWith('http')
                            ? 'noopener noreferrer'
                            : undefined
                        }
                        class="text-primary hover:text-primary-light mt-1 inline-block text-sm transition-colors"
                      >
                        {method.value}
                      </a>
                    ) : (
                      <span class="text-foreground-subtle mt-1 inline-block text-sm">
                        {method.value}
                      </span>
                    )}
                  </div>
                </div>
              ))
            }
          </div>

          <!-- FAQ or additional info -->
          <div class="mt-12">
            <h3 class="text-xl font-semibold">{t.contact.whatToExpect}</h3>
            <ul class="text-foreground-muted mt-4 space-y-3">
              {
                t.contact.expectations.map((expectation) => (
                  <li class="flex items-start gap-3">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      class="text-primary mt-0.5 shrink-0"
                    >
                      <path d="m9 12 2 2 4-4" />
                    </svg>
                    <span>{expectation}</span>
                  </li>
                ))
              }
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>
